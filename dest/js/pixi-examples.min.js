const bpc={};function getParameterByName(e){const t=RegExp(`[?&]${e}=([^&]*)`).exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))}function getMajorPixiVersion(e){let t=6;return"v"===e.substr(0,1)&&(t=parseInt(e.substr(1,1),10)),t}function reload(){bpc.editor&&(bpc.exampleSourceCode=bpc.editor.getValue()),bpc.generateIFrameContent()}function removeAllIFrames(){const e=document.querySelectorAll("iframe, .frame-placeholder");for(let t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t])}jQuery(document).ready(e=>{window.onpopstate=function(t){bpc.pixiVersionString=getParameterByName("v")||"dev",bpc.generateIFrameContent(),e(".select-group .select li.selected").removeClass("selected");const a=e(`.select-group .select li[data-val="${bpc.pixiVersionString}"]`);a.addClass("selected"),e(".select-group .select .current").text(a.text()),e(".main-content").animate({scrollTop:0},200)},bpc.allowedVersions=[6,5],bpc.pixiVersionString=getParameterByName("v")||"dev",bpc.majorPixiVersion=getMajorPixiVersion(bpc.pixiVersionString),bpc.exampleUrl="",bpc.exampleFilename="",bpc.exampleTitle="",bpc.exampleSourceCode="",bpc.exampleRequiredPlugins=[],bpc.exampleValidVersions=[],bpc.editorOptions={mode:"javascript",lineNumbers:!0,styleActiveLine:!0,matchBrackets:!0,viewportMargin:1/0,lineWrapping:!0},bpc.clickType="click",bpc.animTime=.15,bpc.autoPlay=!0,bpc.packagesManifest={},bpc.init=function(){const t=bpc.embedMode();e.getJSON("examples/manifest.json",t=>{const a=Object.keys(t);for(let i=0;i<a.length;i++){let n=`<span class="section" data-section="${a[i]}">${a[i]}</span><ul data-section="${a[i]}">`;const s=t[a[i]];for(let e=0;e<s.length;e++){const t=void 0!==s[e].plugins?s[e].plugins.join(","):"",a=void 0!==s[e].validVersions?s[e].validVersions.join(","):"";n+=`<li data-src="${s[e].entry}" data-plugins="${t}" data-validVersions="${a}">${s[e].title}</li>`}n+="</ul>",e(".main-menu").append(n)}bpc.initNav()}),t||e.getJSON("https://api.github.com/repos/pixijs/pixi.js/git/refs/tags",t=>{let a=[];bpc.allowedVersions.forEach(e=>{let i=t.filter(t=>0===t.ref.indexOf(`refs/tags/v${e}`));i.length>5&&(i=i.slice(-5)),a=a.concat(i)}),a=a.map(e=>e.ref.replace("refs/tags/",""));for(let t=0;t<a.length;t++)e(".select-group .select ul").append(`<li data-val="${a[t]}">${a[t]}</li>`);e.getJSON("https://api.github.com/repos/pixijs/pixi.js/git/refs/heads",t=>{t=t.filter(e=>0===e.ref.indexOf("refs/heads/next")).map(e=>e.ref.replace("refs/heads/",""));for(let a=0;a<t.length;a++)e(".select-group .select ul").append(`<li data-val="${t[a]}">${t[a]}</li>`);const a=e(`.select-group .select li[data-val="${bpc.pixiVersionString}"]`);a.addClass("selected"),e(".select-group .select .current").text(a.text())})})},bpc.embedMode=function(){if(!getParameterByName("lite")&&!getParameterByName("embed"))return!1;const t=e("body"),a=e(".reload");if(t.addClass("embed").removeClass("normal"),e("#redirect").attr("href",window.location.href.replace(window.location.search,"")),bpc.autoPlay=!!getParameterByName("autoplay"),bpc.autoPlay?t.addClass("autoplay"):a.on(bpc.clickType,(function(){e(this).addClass("hidden")})),getParameterByName("noredirect")&&t.addClass("noredirect"),getParameterByName("showcode")){const i=e(".main-tab");t.addClass(i.filter(".selected").data("view")),i.on(bpc.clickType,(function(){i.removeClass("selected"),e(this).addClass("selected"),i.each((function(){t.removeClass(this.dataset.view)})),t.addClass(this.dataset.view),a.addClass("hidden"),reload()}))}else t.addClass("nocode");return!0},bpc.initNav=function(){if(e(".main-menu .section").on(bpc.clickType,(function(){e(this).next("ul").slideToggle(250),e(this).toggleClass("open")})),e(".main-menu li").on(bpc.clickType,(function(){if(!e(this).hasClass("selected")){e(".main-menu li.selected").removeClass("selected"),e(this).addClass("selected"),bpc.closeMobileNav();const t=`/${e(this).parent().attr("data-section")}/${e(this).attr("data-src")}`;bpc.exampleTitle=e(this).text(),window.location.hash=t,document.title=`${bpc.exampleTitle} - PixiJS Examples`,ga("set",{page:t,title:bpc.exampleTitle}),ga("send","pageview"),bpc.exampleUrl=`examples/js/${e(this).parent().attr("data-section")}/${e(this).attr("data-src")}`,bpc.exampleFilename=e(this).attr("data-src");const a=e(this).attr("data-plugins");bpc.exampleRequiredPlugins=""===a?[]:a.split(",");const i=e(this).attr("data-validVersions");bpc.exampleValidVersions=""===i?[6,5]:i.split(",").map(e=>parseInt(e,10)),e.ajax({url:`examples/js/${e(this).parent().attr("data-section")}/${e(this).attr("data-src")}`,dataType:"text",success(e){bpc.exampleSourceCode=e,bpc.loadPackages()}})}})),bpc.loadPackages=function(){e.getJSON("examples/packages.json",e=>{bpc.packagesManifest=e,bpc.autoPlay&&bpc.generateIFrameContent()})},bpc.generateIFrameContent=function(){const t=bpc.packagesManifest;removeAllIFrames(),e("#example").html('<iframe id="preview" src="blank.html"></iframe>'),e(".CodeMirror").remove(),e(".main-content #code").html(bpc.exampleSourceCode);let a="";a="local"===bpc.pixiVersionString?"dist/pixi.js":`https://d157l7jdn8e5sf.cloudfront.net/${bpc.pixiVersionString}/pixi-legacy.js`;let i="<!DOCTYPE html><html><head><style>";i+="body,html{margin:0px;height:100%;overflow:hidden;}canvas{width:100%;height:100%;}",i+="</style></head><body>",i+='<script src="https://code.jquery.com/jquery-3.3.1.min.js"><\/script>',i+=`<script src="${a}"><\/script>`;const n=[];for(let e=0;e<bpc.exampleRequiredPlugins.length;e++){const a=bpc.exampleRequiredPlugins[e],s=t[a];if(s){const e=`${s.vendor?s.vendor.replace("{version}",bpc.pixiVersionString):`https://cdn.jsdelivr.net/npm/${a}@${s.version||"latest"}/`}${s.script}`;i+=`<script src="${e}"><\/script>`,n.push(`<a href="${e}">${a}</a>`)}else i+=`<script src="pixi-plugins/${bpc.exampleRequiredPlugins[e]}.js"><\/script>`,n.push(a)}bpc.editor=CodeMirror.fromTextArea(document.getElementById("code"),bpc.editorOptions),bpc.exampleRequiredPlugins.length?e("#code-header").html(`Example Code (plugins used: ${n.join(", ")})`):e("#code-header").text("Example Code"),!bpc.exampleValidVersions.length||bpc.exampleValidVersions.indexOf(bpc.majorPixiVersion)>-1?(e("#example-title").html(bpc.exampleTitle),i+=`<script>window.onload = function(){${bpc.exampleSourceCode}}<\/script></body></html>`,e(".example-frame").show()):(e("#example-title").html(`${bpc.exampleTitle}<br><br><br><br><br><br><br>`+"The selected version of PixiJS does not work with this example.<br><br>"+`Selected version: v${bpc.majorPixiVersion}<br><br>`+`Required version: v${bpc.exampleValidVersions.toString()}<br><br><br><br><br>`),e(".example-frame").hide());const s=document.getElementById("preview"),c=s.contentDocument||s.contentWindow.document;c.open(),c.write(i),c.close()},bpc.openMobileNav=function(){TweenMax.to("#line1",bpc.animTime,{y:0,ease:Linear.easeNone}),TweenMax.to("#line2",0,{alpha:0,ease:Linear.easeNone,delay:bpc.animTime}),TweenMax.to("#line3",bpc.animTime,{y:0,ease:Linear.easeNone}),TweenMax.to("#line1",bpc.animTime,{rotation:45,ease:Quart.easeOut,delay:bpc.animTime}),TweenMax.to("#line3",bpc.animTime,{rotation:-45,ease:Quart.easeOut,delay:bpc.animTime}),e(".main-nav").addClass("mobile-open")},bpc.closeMobileNav=function(){TweenMax.to("#line1",bpc.animTime,{rotation:0,ease:Linear.easeNone,delay:0}),TweenMax.to("#line3",bpc.animTime,{rotation:0,ease:Linear.easeNone,delay:0}),TweenMax.to("#line2",0,{alpha:1,ease:Quart.easeOut,delay:bpc.animTime}),TweenMax.to("#line1",bpc.animTime,{y:-8,ease:Quart.easeOut,delay:bpc.animTime}),TweenMax.to("#line3",bpc.animTime,{y:8,ease:Quart.easeOut,delay:bpc.animTime}),e(".main-nav").removeClass("mobile-open")},bpc.updateMenu=function(){e(".main-nav .main-menu ul li").each((function(){const t=e(this).attr("data-validVersions");-1===(""===t?[6,5]:t.split(",").map(e=>parseInt(e,10))).indexOf(bpc.majorPixiVersion)?e(this).addClass("invalid"):e(this).removeClass("invalid")}))},bpc.updateMenu(),e(".main-header .hamburger").on(bpc.clickType,t=>(t.preventDefault(),e(".main-nav").hasClass("mobile-open")?bpc.closeMobileNav():bpc.openMobileNav(),!1)),""!==window.location.hash){const t=window.location.hash.replace("#/","").split("/");t.length>1&&("mesh"===t[0]&&(t[0]="mesh-and-shaders"),e(`.main-menu .section[data-section="${t[0]}"]`).length>0&&(e(`.main-menu .section[data-section="${t[0]}"]`).trigger(bpc.clickType),e(`.main-menu .section[data-section="${t[0]}"]`).next().find(`li[data-src="${t[1]}"]`).length>0&&e(`.main-menu .section[data-section="${t[0]}"]`).next().find(`li[data-src="${t[1]}"]`).trigger(bpc.clickType)))}else e(".main-menu .section").eq(0).trigger(bpc.clickType),e(".main-menu li").eq(0).trigger(bpc.clickType);e(".select-group").on(bpc.clickType,(function(){e(this).find(".select").hasClass("open")?(e(this).find(".select").removeClass("open"),e(this).find("ul").slideUp(150)):(e(this).find(".select").addClass("open"),e(this).find("ul").slideDown(150))})),e(".select-group .select").on(bpc.clickType,"li",(function(){e(this).hasClass("selected")||(e(".select-group .select li.selected").removeClass("selected"),e(this).addClass("selected"),e(".select-group .select .current").text(e(this).text()),bpc.pixiVersionString=e(this).attr("data-val"),bpc.majorPixiVersion=getMajorPixiVersion(bpc.pixiVersionString),window.history.pushState(bpc.pixiVersionString,null,`?v=${bpc.pixiVersionString}${window.location.hash}`),bpc.updateMenu(),bpc.generateIFrameContent(),e(".main-content").animate({scrollTop:0},200))})),e(".footer .download").on(bpc.clickType,()=>{bpc.saveToDisk(bpc.exampleUrl,bpc.exampleFilename)}),e(".reload").on(bpc.clickType,reload)},bpc.saveToDisk=function(e,t){if(window.ActiveXObject){if(window.ActiveXObject&&document.execCommand){const a=window.open(e,"_blank");a.document.close(),a.document.execCommand("SaveAs",!0,t||e),a.close()}}else{const a=document.createElement("a");a.href=e,a.target="_blank",a.download=t||"unknown";const i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});a.dispatchEvent(i),(window.URL||window.webkitURL).revokeObjectURL(a.href)}},bpc.init()});